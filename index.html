<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Meta and Title -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AZ Sports - Enhanced Product Carousel</title>

    <!-- External Styles and Scripts -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
    <!-- Google Fonts: Anton for product names, Roboto Condensed for other texts -->
    <link href="https://fonts.googleapis.com/css2?family=Anton&family=Roboto+Condensed:wght@400;700&display=swap" rel="stylesheet">
    <!-- Use the production build of Vue.js -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
    <!-- Include anime.js for animations -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>

    <!-- Inline Styles -->
    <style>
        /* General Styles */
        body {
            margin: 0;
            font-family: 'Roboto Condensed', sans-serif; /* Default font for body */
            overflow-x: hidden;
            background-color: #f4f6f9; /* Light grey background */
        }
        #app-wrapper {
            position: relative;
            overflow: hidden;
        }

        #app {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 1;
        }

        /* Logo and Navigation */
        .logo, .nav-circle {
            position: fixed; 
            z-index: 1000; 
            border-radius: 50%; 
            display: flex; 
            align-items: center; 
            justify-content: center;
        }
        .logo {
            top: 20px; 
            left: 20px; 
            width: 100px; 
            height: 100px; 
            background: linear-gradient(145deg, #f0f0f0, #dcdcdc);
            padding: 5px; 
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.15);
        }
        .nav-circle {
            bottom: 30px; 
            right: 30px; 
            width: 60px; 
            height: 60px; 
            background: linear-gradient(135deg, #007bff, #0056b3);
            cursor: pointer; 
            transition: transform 0.3s, background-color 0.3s; 
            font-size: 18px;
            z-index: 1500;
            color: white;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3);
        }
        .nav-circle:hover {
            transform: scale(1.1);
            background-color: #007bff;
            box-shadow: 0 8px 20px rgba(0, 123, 255, 0.5);
        }
        .logo img {
            width: 100%; 
            height: 100%; 
            border-radius: 50%; 
            object-fit: contain;
        }

        /* Menu Overlay and Radial Menu */
        .menu-overlay {
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            background: rgba(0,0,0,0.5); 
            z-index: 1300;
            backdrop-filter: blur(5px);
        }

        /* Radial Menu */
        .radial-menu {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 500px;
            height: 500px;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1400;
            transition: transform 0.2s ease-out;
            perspective: 800px;
        }
        .menu-item {
            position: absolute;
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, #333, #444);
            color: #fff;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            opacity: 0;
            transition: transform 0.5s, opacity 0.5s, box-shadow 0.3s ease-in-out;
            transition-delay: calc(0.05s * var(--menu-index));
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        .menu-item.show {
            opacity: 1;
        }
        .menu-item:hover {
            transform: scale(1.2);
            box-shadow: 0 10px 20px rgba(0, 86, 179, 0.5), 0 0 15px rgba(0, 86, 179, 0.6);
        }
        .menu-item i {
            font-size: 1.5em;
        }
        .menu-label {
            font-size: 0.8em;
            margin-top: 5px;
            text-align: center;
        }

        /* Parallax Effect for Radial Menu */
        .radial-menu:hover {
            transform: perspective(800px) rotateX(15deg) rotateY(15deg);
        }

        /* Center Logo in Radial Menu */
        .menu-center-logo {
            position: absolute;
            top: 50%;
            left: 50%;
            z-index: 1;
            transform: translate(-50%, -50%);
            animation: logoPop 0.5s ease-out;
        }
        .menu-center-logo img {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            object-fit: contain;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
        }
        .menu-center-logo img:hover {
            transform: rotate(10deg) scale(1.1);
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.7);
        }

        @keyframes logoPop {
            0% {
                transform: translate(-50%, -50%) scale(0);
            }
            100% {
                transform: translate(-50%, -50%) scale(1);
            }
        }

        /* Enhanced Carousel Container with 3D Effects */
        .carousel-container {
            width: 100%;
            max-width: 1200px; /* Adjust as needed */
            margin: 100px auto 40px auto; /* Centers the container with top and bottom margins */
            padding: 30px; /* Reduced padding to minimize empty space */
            background: radial-gradient(circle at top left, #ffffff, #f0f0f0);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2), inset 0 0 10px rgba(255,255,255,0.1);
            border-radius: 20px; /* Reduced border radius for a sleeker look */
            transform-style: preserve-3d;
            transition: transform 1s ease, box-shadow 0.3s ease;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: space-between; /* Better distribution */
            gap: 30px; /* Reduced gap */
            flex-wrap: nowrap; /* Prevent wrapping */
        }

        .carousel-container::before,
        .carousel-container::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background: inherit;
            border-radius: 20px; /* Match container's border radius */
            top: 0;
            left: 0;
            transform: rotateY(0deg) translateZ(-10px);
            z-index: -1;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.1), 0 0 20px rgba(255,255,255,0.2);
        }

        /* Add 3D Rotation on Hover with Anime.js Integration */
        .carousel-container:hover {
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.3);
        }

        /* Product Carousel Styles */
        .product-carousel {
            position: relative; 
            width: 100%; 
            max-width: 800px; 
            height: 500px; /* Reduced height */
            perspective: 1800px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            overflow: hidden; 
            z-index: 1000;
        }
        .carousel-item {
            position: absolute;
            width: 200px; /* Reduced width */
            height: 380px; /* Further reduced height */
            transform-origin: center;
            border-radius: 15px; /* Slightly reduced border radius */
            background: white;
            border: 2px solid #e0f7fa; /* Light blue border matching branding */
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
            opacity: 0.85; /* Slightly increased opacity for better visibility */
            transition: transform 0.6s cubic-bezier(0.25,1,0.5,1), opacity 0.5s, box-shadow 0.6s;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: flex-start; /* Align content at the top */
            box-sizing: border-box; /* Include border and padding in width/height */
            cursor: pointer;
        }
        .carousel-item.active {
            /* Removed transform to prevent conflict */
            box-shadow: 0 14px 35px rgba(0, 86, 179, 0.6); /* Enhanced shadow for active item */
            z-index: 3;
            opacity: 1;
        }
        .carousel-item:hover {
            transform: translateZ(220px) scale(1.25) rotateY(5deg);
            box-shadow: 0 18px 45px rgba(0, 86, 179, 0.7); /* Further enhanced shadow */
        }

        /* Image Styles - Combined Glass & Neon Glow Effect */
        .product-image {
            width: 100%;
            height: 180px; /* Reduced height */
            object-fit: cover;
            border-radius: 12px 12px 0 0; /* Slightly reduced border radius */
            border: 2px solid rgba(255, 255, 255, 0.4); /* Transparent glass-like border */
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2); /* Subtle shadow */
            transition: transform 0.3s ease, box-shadow 0.3s ease, border-color 0.3s ease;
            background-color: rgba(255, 255, 255, 0.2); /* Glass effect background */
            margin-bottom: 0;
            box-sizing: border-box; /* Ensures border fits inside container */
        }

        .carousel-item:hover .product-image {
            transform: scale(1.08); /* Slight zoom */
            border-color: rgba(0, 123, 255, 0.6); /* Stronger glass border effect */
            box-shadow: 0 8px 20px rgba(0, 123, 255, 0.5), 0 0 20px rgba(0, 123, 255, 0.7); /* Neon glow */
        }

        /* Product Info with Flexbox for Alignment */
        .product-info {
            padding: 8px 12px; /* Further reduced padding */
            background: #f7f9fc;
            text-align: center;
            flex-grow: 1;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            border-top: 1px solid #ddd;
            border-radius: 0 0 15px 15px; /* Match border radius */
        }
        .product-info h3 {
            margin: 5px 0 3px;
            font-family: 'Anton', sans-serif; /* Sports-themed font for product names */
            font-size: 1.3em; /* Further reduced font size */
            font-weight: 400; /* Adjusted font weight */
            color: #222;
            min-height: 36px; /* Reduced min-height */
            line-height: 1.2; /* Improved line height */
        }
        .product-info p.price {
            font-size: 0.95em; /* Slightly reduced font size */
            color: #007bff; /* Branded blue color */
            font-weight: bold;
            margin: 3px 0;
        }
        .product-info .rating {
            color: #ffc107;
            margin: 3px 0;
            font-size: 0.85em; /* Reduced icon size */
        }
        .product-info .actions {
            display: flex;
            justify-content: center;
            gap: 6px; /* Further reduced gap */
        }
        .product-info .actions button {
            padding: 6px 10px; /* Further reduced padding */
            border-radius: 6px; /* Reduced border radius */
            background: linear-gradient(145deg, #007bff, #0056b3);
            color: #fff;
            font-size: 0.8em; /* Further reduced font size */
            font-weight: 600;
            box-shadow: 0 4px 10px rgba(0, 123, 255, 0.4);
            transition: background 0.3s, transform 0.3s, box-shadow 0.3s;
            border: none;
            cursor: pointer;
        }
        .product-info .actions button:hover {
            background: #007bff;
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0, 123, 255, 0.5);
        }

        /* Badge Styles */
        .product-badge {
            position: absolute;
            top: 8px;
            left: 8px;
            background: linear-gradient(145deg, #ff4444, #ff0000);
            color: #fff;
            padding: 5px 7px; /* Further reduced padding */
            font-size: 0.75em; /* Further reduced font size */
            border-radius: 8px; /* Reduced border radius */
            animation: badgePulse 1.5s infinite ease-in-out;
            box-shadow: 0 0 10px rgba(255, 0, 0, 0.5);
        }
        @keyframes badgePulse {
            0%, 100% { transform: scale(1); box-shadow: 0 0 5px rgba(255,0,0,0.4); }
            50% { transform: scale(1.1); box-shadow: 0 0 15px rgba(255,0,0,0.7); }
        }

        /* Product Modal */
        .product-modal {
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            background: rgba(0,0,0,0.5); 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            z-index: 2000;
        }
        .modal-content {
            background: #fff; 
            padding: 20px; 
            border-radius: 10px; 
            width: 80%; 
            max-width: 500px; 
            text-align: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            position: relative;
        }
        .modal-content button {
            margin-top: 20px;
            padding: 10px 20px;
            background: #007bff;
            color: #fff;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.3s, transform 0.3s;
        }
        .modal-content button:hover {
            background: #0056b3;
            transform: translateY(-2px);
        }

        /* Autoplay Toggle (Play/Pause Icon) */
        .description-area .autoplay-toggle {
            margin-top: 15px; /* Slightly reduced space above the button */
            background: none; /* Remove background */
            border: none; /* Remove border */
            cursor: pointer;
            font-size: 1.3em; /* Adjust icon size */
            color: #007bff; /* Branded blue color */
            transition: color 0.3s, transform 0.3s;
        }
        .description-area .autoplay-toggle:hover {
            color: #0056b3; /* Darker blue on hover */
            transform: scale(1.1); /* Slightly enlarge on hover */
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .carousel-container {
                flex-direction: row;
                gap: 20px;
            }
            .description-area {
                max-width: 400px;
            }
        }
        @media (max-width: 768px) {
            .carousel-container {
                flex-direction: column;
                gap: 20px;
            }
            .description-area {
                max-width: 90%;
            }
            .menu-item {
                position: relative;
                width: 100%;
                height: auto;
                border-radius: 0;
                margin: 10px 0;
                transform: none !important;
            }
            .nav-circle {
                width: 60px;
                height: 60px;
                font-size: 18px;
            }
            /* Remove the old autoplay-toggle button if present */
            /* Removed previously existing autoplay-toggle styles */
            .product-carousel {
                height: 440px;
            }
            .carousel-item {
                width: 180px;
                height: 300px; /* Reduced from 380px to 300px */
            }
            .product-image {
                height: 140px; /* Reduced from 180px to 140px */
            }
            .product-info {
                height: auto; /* Ensure height adjusts based on content */
                padding: 6px 10px; /* Further reduced padding */
                display: flex;
                flex-direction: column;
                justify-content: flex-start; /* Align items to top */
                align-items: center; /* Center align content */
                text-align: center; /* Center text */
            }

            /* **New Mobile-Specific Styles** */

            /* Adjust Product Name Font Size */
            .product-info h3 {
                font-size: 1.2em; /* Maintain readability */
                min-height: 30px; /* Adjusted from 36px */
                margin: 4px 0 1px; /* Further reduced margins */
                line-height: 1.1; /* Slightly reduced line height */
            }

            /* Adjust Price Font Size */
            .product-info p.price {
                font-size: 0.9em; /* Slightly reduced for mobile */
                margin: 1px 0; /* Further reduced margin */
            }

            /* Adjust Rating Icons Size */
            .product-info .rating i {
                font-size: 0.7em; /* Reduced from 0.85em */
                margin: 0 0.3px; /* Further reduced margin */
            }

            /* Reorganize Actions (Buttons) */
            .product-info .actions {
                flex-direction: column; /* Stack buttons vertically */
                gap: 4px; /* Further reduced gap between buttons */
                width: 100%; /* Make buttons full width */
                align-items: center; /* Center align buttons */
            }

            /* Adjust Buttons Size and Font */
            .product-info .actions button {
                padding: 5px 8px; /* Further reduced padding */
                font-size: 0.75em; /* Further reduced font size */
                width: 100%; /* Full width for better touch targets */
                box-sizing: border-box; /* Ensure padding doesn't exceed container */
                box-shadow: 0 2px 6px rgba(0, 123, 255, 0.3); /* Reduced shadow */
            }

            /* Optional: Reduce Badge Size on Mobile */
            .product-badge {
                padding: 4px 6px; /* Further reduced padding */
                font-size: 0.7em; /* Further reduced font size */
            }

            /* Adjust Description Area for Mobile */
            .description-area {
                max-width: 90%;
            }
        }

        /* Prevent body scroll when menu is open */
        body.menu-open {
            overflow: hidden;
        }

        /* Scaling for active item content */
        .item-content {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            margin-top: 10px; /* Added margin-top to shift content downward */
        }
        .carousel-item.active .item-content {
            transform: scale(1.05); /* Slightly scale the content */
        }

        /* Description Area Styles */
        .description-area {
            width: 100%;
            max-width: 400px;
            background: #ffffff;
            padding: 18px; /* Slightly reduced padding */
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            text-align: center;
            transition: opacity 0.5s ease, transform 0.3s ease;
        }
        .description-area.hidden {
            opacity: 0;
            transform: translateY(20px);
            pointer-events: none;
        }
        .description-area.visible {
            opacity: 1;
            transform: translateY(0);
        }
        .description-area h2 {
            margin-bottom: 8px; /* Reduced margin */
            font-size: 1.4em; /* Slightly reduced font size */
            color: #007bff;
            font-family: 'Anton', sans-serif; /* Apply sports-themed font */
        }
        .description-area p {
            font-size: 0.95em; /* Slightly reduced font size */
            color: #555;
            line-height: 1.4; /* Improved readability */
        }

    </style>
</head>
<body>
    <div id="app-wrapper">
        <div id="app" @keydown.esc="closeMenu" tabindex="0">
            <!-- Logo -->
            <div class="logo">
                <img src="./images/logo2.png" alt="AZ Sports Logo">
            </div>

            <!-- Navigation Circle -->
            <div class="nav-circle" @click="toggleMenu" aria-label="Open Navigation Menu" role="button" tabindex="0">
                <i class="fas fa-bars" style="color: white;"></i>
            </div>

            <!-- Menu Overlay -->
            <div v-if="menuOpen" class="menu-overlay" @click="toggleMenu"></div>

            <!-- Radial Menu -->
            <div class="radial-menu" v-if="menuOpen" @mousemove="handleMouseMove" role="navigation" aria-label="Main Navigation">
                <!-- Center Logo -->
                <div class="menu-center-logo">
                    <img src="./images/logo2.png" alt="AZ Sports Logo">
                </div>
                <!-- Menu Items -->
                <div v-for="(item, index) in navItems" 
                     :key="item.name" 
                     :class="['menu-item', { show: menuOpen }]" 
                     :style="[getMenuItemStyle(index), { '--menu-index': index }]" 
                     tabindex="0" 
                     @keydown.enter="scrollToSection(item.path)">
                    <a href="#" @click.prevent="scrollToSection(item.path)" style="color: inherit; text-decoration: none; display: flex; flex-direction: column; align-items: center;">
                        <i :class="item.icon"></i>
                        <span class="menu-label">{{ item.name }}</span>
                    </a>
                </div>
            </div>

            <!-- 3D Carousel and Description Container -->
            <div class="carousel-container" role="region" aria-label="Product Carousel and Description">
                <!-- Product Carousel -->
                <div
                  class="product-carousel"
                  @wheel.prevent="handleMouseWheel"
                  @mousedown="startDrag"
                  @mouseup="endDrag"
                  @mousemove="onDrag"
                  @touchstart="startDrag"
                  @touchend="endDrag"
                  @touchmove="onDrag"
                  @mouseenter="pauseAutoplay"
                  @mouseleave="resumeAutoplay"
                >
                    <div
                      class="carousel-item"
                      v-for="(product, index) in products"
                      :key="index"
                      :style="getItemStyle(index)"
                      :class="{ active: index === activeIndex }"
                      role="button"
                      aria-label="Buy {{ product.name }}"
                      tabindex="0"
                      @click="buyNow(product)"
                      @click.once="animateCarouselItem($event.currentTarget)"
                      @keydown.enter="buyNow(product)"
                    >
                        <div class="item-content">
                            <div v-if="product.badge" class="product-badge">{{ product.badge }}</div>
                            <img 
                                :src="product.imageSmall" 
                                :srcset="`${product.imageSmall} 480w, ${product.imageMedium} 768w, ${product.image} 1200w`" 
                                :sizes="'(max-width: 480px) 100vw, (max-width: 768px) 50vw, 33vw'" 
                                :alt="product.name" 
                                class="product-image" 
                                loading="lazy">
                            <div class="product-info">
                                <h3>{{ product.name }}</h3>
                                <p class="price">{{ product.price }}</p>
                                <div class="rating">
                                    <i class="fas fa-star" v-for="n in 5" :key="n"></i>
                                </div>
                                <div class="actions">
                                    <button @click.stop="addToCart(product)">Add to Cart</button>
                                    <!-- Changed "View Details" to "Buy Now" -->
                                    <button @click.stop="buyNow(product)">Buy Now</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Description Area -->
                <div 
                    class="description-area" 
                    :class="{ visible: selectedProduct.name, hidden: !selectedProduct.name }" 
                    v-if="selectedProduct.name"
                >
                    <h2>{{ selectedProduct.name }}</h2>
                    <p>{{ selectedProduct.description }}</p>
                    <!-- Play/Pause Autoplay Button -->
                    <button 
                        class="autoplay-toggle" 
                        @click="toggleAutoplay" 
                        :aria-label="autoplay ? 'Pause Autoplay' : 'Start Autoplay'"
                        :aria-pressed="autoplay"
                    >
                        <i :class="autoplay ? 'fas fa-pause' : 'fas fa-play'"></i>
                    </button>
                </div>
            </div>

            <!-- Product Modal (Optional) -->
            <!-- If you still want to keep the modal, you can leave it; otherwise, you can remove it -->
            <div v-if="showModal" class="product-modal" @click="closeModal" role="dialog" aria-modal="true" aria-labelledby="modal-title">
                <div class="modal-content" @click.stop>
                    <h2 id="modal-title">{{ selectedProduct.name }}</h2>
                    <p>{{ selectedProduct.price }}</p>
                    <p>{{ selectedProduct.description }}</p>
                    <button @click="closeModal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Vue Script -->
    <script>
        const { createApp, ref, onMounted, watch, onBeforeUnmount } = Vue;
        createApp({
            setup() {
                const menuOpen = ref(false);
                const navItems = ref([
                    { name: 'Home', path: '#home', icon: 'fas fa-home' },
                    { name: "Men's Collection", path: '#mens-collection', icon: 'fas fa-male' },
                    { name: "Women's Collection", path: '#womens-collection', icon: 'fas fa-female' },
                    { name: "Kids' Collection", path: '#kids-collection', icon: 'fas fa-child' },
                    { name: 'New Arrivals', path: '#new-arrivals', icon: 'fas fa-tags' },
                    { name: 'Sale', path: '#sale', icon: 'fas fa-percent' },
                    { name: 'Contact Us', path: '#contact', icon: 'fas fa-envelope' },
                ]);

                const products = ref([
                    { 
                        name: 'Nike Air Zoom Pegasus', 
                        price: '$120', 
                        image: 'https://via.placeholder.com/200x380.webp', 
                        imageSmall: 'https://via.placeholder.com/200x380.webp', 
                        imageMedium: 'https://via.placeholder.com/200x380.webp',
                        description: 'High-performance running shoes with responsive cushioning.', 
                        badge: 'New' 
                    },
                    { 
                        name: 'Adidas Ultraboost 21', 
                        price: '$180', 
                        image: 'https://via.placeholder.com/200x380.webp', 
                        imageSmall: 'https://via.placeholder.com/200x380.webp', 
                        imageMedium: 'https://via.placeholder.com/200x380.webp',
                        description: 'Boost cushioning technology for maximum comfort.' 
                    },
                    { 
                        name: 'Puma Running Shoes', 
                        price: '$90', 
                        image: 'https://via.placeholder.com/200x380.webp', 
                        imageSmall: 'https://via.placeholder.com/200x380.webp', 
                        imageMedium: 'https://via.placeholder.com/200x380.webp',
                        description: 'Lightweight and breathable running shoes for everyday use.', 
                        badge: 'On Sale' 
                    },
                    { 
                        name: 'Reebok Crossfit Nano', 
                        price: '$110', 
                        image: 'https://via.placeholder.com/200x380.webp', 
                        imageSmall: 'https://via.placeholder.com/200x380.webp', 
                        imageMedium: 'https://via.placeholder.com/200x380.webp',
                        description: 'Designed for high-intensity crossfit training.' 
                    },
                    { 
                        name: 'Under Armour Hovr', 
                        price: '$130', 
                        image: 'https://via.placeholder.com/200x380.webp', 
                        imageSmall: 'https://via.placeholder.com/200x380.webp', 
                        imageMedium: 'https://via.placeholder.com/200x380.webp',
                        description: 'Provides a zero-gravity feel to maintain energy return.' 
                    },
                ]);

                const rotationAngle = ref(0);
                const activeIndex = ref(0);
                const showModal = ref(false);
                const selectedProduct = ref({});
                const autoplay = ref(true);
                const isMobile = ref(window.innerWidth <= 768);
                let autoplayInterval;
                let isDragging = false;
                let startX = 0;

                // Function to update isMobile based on window width
                const updateIsMobile = () => {
                    isMobile.value = window.innerWidth <= 768;
                };

                window.addEventListener('resize', updateIsMobile);

                const calculatePosition = (index, totalItems) => {
                    const angle = (360 / totalItems) * index - 90;
                    const radius = 200;
                    const x = radius * Math.cos((angle * Math.PI) / 180);
                    const y = radius * Math.sin((angle * Math.PI) / 180);
                    return { transform: `translate(${x}px, ${y}px)` };
                };

                const getMenuItemStyle = (index) => {
                    if (isMobile.value) {
                        return { transform: 'none' };
                    }
                    return calculatePosition(index, navItems.value.length);
                };

                const toggleMenu = () => { menuOpen.value = !menuOpen.value; };

                const getItemStyle = (index) => {
                    const angle = (360 / products.value.length) * index + rotationAngle.value;
                    const zIndex = Math.round((Math.cos((angle * Math.PI) / 180) + 1) * 5);
                    return { transform: `rotateY(${angle}deg) translateZ(300px)`, zIndex };
                };

                const rotateCarousel = (direction) => {
                    rotationAngle.value += direction * (360 / products.value.length);
                    activeIndex.value = (activeIndex.value + direction + products.value.length) % products.value.length;
                    updateSelectedProduct();
                };

                const handleMouseWheel = (event) => {
                    event.preventDefault();
                    rotateCarousel(event.deltaY > 0 ? 1 : -1);
                };

                const startDrag = (event) => {
                    isDragging = true;
                    startX = event.clientX || event.touches[0].clientX;
                };

                const endDrag = () => { isDragging = false; };

                const onDrag = (event) => {
                    if (!isDragging) return;
                    const currentX = event.clientX || event.touches[0].clientX;
                    const delta = currentX - startX;
                    if (Math.abs(delta) > 50) {
                        rotateCarousel(delta > 0 ? -1 : 1);
                        startX = currentX;
                    }
                };

                const showProductDetails = (product) => {
                    selectedProduct.value = product;
                    showModal.value = true;
                };

                const closeModal = () => { showModal.value = false; };

                const startAutoplay = () => {
                    autoplayInterval = setInterval(() => { rotateCarousel(1); }, 3000);
                };

                const pauseAutoplay = () => { clearInterval(autoplayInterval); };
                const resumeAutoplay = () => { if (autoplay.value) startAutoplay(); };

                const toggleAutoplay = () => {
                    autoplay.value = !autoplay.value;
                    autoplay.value ? startAutoplay() : pauseAutoplay();
                };

                const closeMenu = () => {
                    if (menuOpen.value) {
                        menuOpen.value = false;
                    }
                };

                const scrollToSection = (hash) => {
                    const element = document.querySelector(hash);
                    if (element) {
                        element.scrollIntoView({ behavior: 'smooth' });
                        menuOpen.value = false;
                    }
                };

                const addToCart = (product) => {
                    alert(`${product.name} has been added to your cart.`);
                };

                // New Method: Buy Now
                const buyNow = (product) => {
                    // Add to cart
                    addToCart(product);
                    // Redirect to checkout or display a confirmation
                    // For demonstration, we'll use an alert
                    alert(`Proceeding to purchase ${product.name} for ${product.price}.`);
                    // You can replace the above alert with actual navigation to a checkout page
                    // e.g., window.location.href = '/checkout';
                };

                watch(menuOpen, (newValue) => {
                    document.body.classList.toggle('menu-open', newValue);
                });

                const handleMouseMove = (event) => {
                    const x = (event.clientX / window.innerWidth) * 100 - 50;
                    const y = (event.clientY / window.innerHeight) * 100 - 50;
                    const radialMenu = document.querySelector('.radial-menu');
                    radialMenu.style.transform = `translate(-50%, -50%) perspective(800px) rotateY(${x / 10}deg) rotateX(${-y / 10}deg)`;
                };

                // Keyboard navigation for carousel
                const handleKeyDown = (event) => {
                    if (event.key === 'ArrowRight') {
                        rotateCarousel(1); // Rotate right
                    } else if (event.key === 'ArrowLeft') {
                        rotateCarousel(-1); // Rotate left
                    }
                };

                // Integrate anime.js for smooth container animations
                const animateContainer = () => {
                    const carouselContainer = document.querySelector('.carousel-container');
                    anime({
                        targets: carouselContainer,
                        rotateY: '+=15deg',
                        duration: 10000, // Long duration for smooth rotation
                        easing: 'linear',
                        loop: true
                    });
                };

                // Function to animate carousel item on click
                const animateCarouselItem = (element) => {
                    anime({
                        targets: element,
                        scale: [1, 1.05, 1],
                        duration: 600,
                        easing: 'easeInOutSine'
                    });
                };

                // Add method to go to a specific index
                const goToIndex = (index) => {
                    const direction = index > activeIndex.value ? 1 : -1;
                    rotateCarousel(direction);
                    activeIndex.value = index;
                    updateSelectedProduct();
                };

                const rotateContainer = (direction) => {
                    const carouselContainer = document.querySelector('.carousel-container');
                    const angle = direction === 'left' ? '-=15deg' : '+=15deg';
                    anime({
                        targets: carouselContainer,
                        rotateY: angle,
                        duration: 1000,
                        easing: 'easeInOutSine'
                    });
                };

                const updateSelectedProduct = () => {
                    selectedProduct.value = products.value[activeIndex.value];
                };

                onMounted(() => {
                    window.addEventListener('keydown', handleKeyDown);
                    if (autoplay.value) startAutoplay();
                    animateContainer(); // Start container animation
                    updateSelectedProduct(); // Initialize selected product
                });

                onBeforeUnmount(() => {
                    window.removeEventListener('keydown', handleKeyDown);
                    clearInterval(autoplayInterval);
                });

                return {
                    menuOpen, navItems, products, getMenuItemStyle, toggleMenu, getItemStyle,
                    handleMouseWheel, startDrag, endDrag, onDrag, showProductDetails, closeModal,
                    activeIndex, showModal, selectedProduct, autoplay, toggleAutoplay,
                    pauseAutoplay, resumeAutoplay, closeMenu, scrollToSection, addToCart,
                    rotateCarousel, handleMouseMove, animateCarouselItem, goToIndex, rotateContainer,
                    buyNow // Expose buyNow method to the template
                };
            }
        }).mount('#app');
    </script>
</body>
</html>
